# TemplateSyntax
[bind:](#bind)
- [Function bindings](#function-bindings)
- [`<input />`](#input-)
- [`<select bind:value>`](#select-bindvalue)
- [`<audio>`](#audio)
- [`<video>`](#video)
- [`<img>`](#img)
- [`<details bind:open>`](#details-bindopen)
- [Contenteditable bindings](#contenteditable-bindings)
- [Dimensions](#dimensions)
- [bind:this](#bindthis)
- [bind:property for components](#bindproperty-for-components)


## bind:
數據通常是從父層流向子層。`bind: `指令允許數據反向流動，從子層流向父層。

```svelte
<input bind:value={value} />
<input bind:value />
```

### Function bindings
⚠️ Svelte 5.9.0 或以上

可以使用 `bind:property={get, set}`，其中 `get` 和 `set` 是函數，允許進行驗證和轉換：
```svelte
<input bind:value={
	() => value,
	(v) => value = v.toLowerCase()
}/>
```

對於只能讀取的綁定，如尺寸綁定，get 值應為 null：
```svelte
<div
	bind:clientWidth={null, redraw}
	bind:clientHeight={null, redraw}
>Apple</div>
```

### `<input />`
```svelte
<script>
	let message = $state('hello');
</script>

<input type="text" bind:value={message} />
<p>{message}</p>

<input type="checkbox" bind:checked={accepted} />

<!-- bind:group 僅在 input 位於同一 Svelte 組件中時才有效。 -->
<input type="radio" bind:group={tortilla} value="Plain" />
<input type="radio" bind:group={tortilla} value="Whole wheat" />
<input type="radio" bind:group={tortilla} value="Spinach" />

```

對於數字輸入（type="number" 或 type="range"），該值將被強制轉換為數字。
```svelte
<script>
	let a = $state(1);
	let b = $state(2);
</script>

<label>
	<input type="number" bind:value={a} min="0" max="10" />
	<input type="range" bind:value={a} min="0" max="10" />
</label>

<label>
	<input type="number" bind:value={b} min="0" max="10" />
	<input type="range" bind:value={b} min="0" max="10" />
</label>

<p>{a} + {b} = {a + b}</p>
```

如果輸入為空或無效（在 `type="number"` 的情況下），值為 `undefined。`
自 5.6.0 版本開始，如果 `<input>` 有 `defaultValue` 並且是表單的一部分，當表單被重置時，它將恢復為該值，而不是空字符串。請注意，對於初始渲染，除非綁定值為 `null` 或 `undefined`，否則綁定值優先。
```svelte
<script>
	let value = $state('');
</script>

<form>
	<input bind:value defaultValue="not the empty string">
	<input type="reset" value="Reset">
</form>
```

使用 `type="file"` 時，您可以使用 `bind:files` 獲取所選文件的 `FileList`。當您想以編程方式更新文件時，您始終需要使用 `FileList` 對象。目前無法直接構造 `FileList` 對象，因此您需要創建一個新的 `DataTransfer` 對象，並從中獲取 `files`。

`FileList` 對象也不能被修改，因此如果您想從列表中刪除單個文件，則需要創建一個新的 `DataTransfer` 對象，並添加您想保留的文件。
```svelte
<script>
	let files = $state();

	function clear() {
		files = new DataTransfer().files; // null 或 undefined 無效
	}
</script>

<label for="avatar">Upload a picture:</label>
<input accept="image/png, image/jpeg" bind:files id="avatar" name="avatar" type="file" />
<button onclick={clear}>clear</button>
```

> `DataTransfer` 在服務器端 JavaScript 運行時可能不可用。將綁定到 `files` 的狀態保持未初始化可以防止組件在服務端渲染時出現潛在錯誤。
```ts
// ❌ 在 SSR 中可能出錯
let files = $state(new DataTransfer().files);

// ✅ 推薦方式 - 保持未初始化
let files = $state(); // undefined
```

### `<select bind:value>`
```svelte
<select bind:value={selected}>
	<option value={a}>a</option>
	<option value={b}>b</option>
	<option value={c}>c</option>
</select>
```

### `<audio>`
`<audio>` 有五個雙向綁定...
- `currentTime`
- `playbackRate`
- `paused`
- `volume`
- `muted`

...以及七個唯讀綁定：:
- `duration`
- `buffered`
- `seekable`
- `seeking`
- `ended`
- `readyState`
- `played`

```svelte
<audio src={clip} bind:duration bind:currentTime bind:paused></audio>
```

### `<video>`
`<video>` 具有與 audio 元素相同的所有綁定，外加唯讀的 `videoWidth` 和 `videoHeight` 綁定

### `<img>`
`<img>` 有兩個唯讀綁定：
- `naturalWidth`
- `naturalHeight`

### `<details bind:open>`
`<details>` 綁定到 open 屬性。
```svelte
<details bind:open={isOpen}>
	<summary>How do you comfort a JavaScript bug?</summary>
	<p>You console it.</p>
</details>
```

### Contenteditable bindings
具有 `contenteditable` 屬性的元素支持以下綁定：
- `innerHTML`
- `innerText`
- `textContent`
```svelte
<div contenteditable="true" bind:innerHTML={html} />
```

### Dimensions
所有可見元素都有以下唯讀綁定，通過 `ResizeObserver` 測量：
- `clientWidth`
- `clientHeight`
- `offsetWidth`
- `offsetHeight`
```svelte
<div bind:offsetWidth={width} bind:offsetHeight={height}>
	<Chart {width} {height} />
</div>
```
> [!NOTE] display: inline 元素沒有寬度或高度（除了具有“固有”尺寸的元素，如 `<img>` 和 `<canvas>`），並且無法通過 ResizeObserver 進行觀察。您需要將這些元素的 display 樣式更改為其他值，例如 inline-block。


### bind:this
要获取对 DOM 节点的引用，请使用 `bind:this`。该值在組件掛載之前是 `undefined` —— 換句話説，您應該在 effect 或事件處理程序內部讀取它，而不是在組件初始化期間讀取：
```svelte
<script>
	/** @type {HTMLCanvasElement} */
	let canvas;

	$effect(() => {
		const ctx = canvas.getContext('2d');
		drawStuff(ctx);
	});
</script>

<canvas bind:this={canvas} />
```

组件也支持 `bind:this`，允许您以编程方式与组件实例进行交互。
`A.svelte`
```svelte
<ShoppingCart bind:this={cart} />

<button onclick={() => cart.empty()}> 清空购物车 </button>
```

`B.svelte`
```svelte
<script>
	// 所有实例导出都可在实例对象上使用
	export function empty() {
		// ...
	}
</script>
```

### bind:property for components
參考 Runes `$bindable`